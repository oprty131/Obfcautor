<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua Script Obfuscator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin: 10px 0;
        }
        button {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-right: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Lua Script Obfuscator</h1>
    <textarea id="luaScript" placeholder="Enter your Lua script here..."></textarea>
    <button onclick="obfuscateLua()">Obfuscate Script</button>
    <button onclick="copyToClipboard()">Copy Obfuscated Script</button>
    <button onclick="downloadFile()">Download Obfuscated Script</button>
    <h3>Obfuscated Script:</h3>
    <textarea id="obfuscatedScript" readonly></textarea>

    <script>
        function encodeBase64(data) {
            return btoa(String.fromCharCode.apply(null, data));
        }

        function obfuscateLua() {
            let script = document.getElementById('luaScript').value;

            // Step 1: LZW Compress the Lua script
            let compressedScript = lzwCompress(script);

            // Step 2: Create a custom encoding for the obfuscated script
            let encodedScript = encodeBase64(compressedScript);

            // Step 3: Generate a randomized obfuscated Lua script
            let randomKey = Math.random().toString(36).substring(2, 15); // Generate a random string key
            let finalObfuscatedScript = `
return (function(Ax, Ck, T1, T2, X4, C5, Xy)
    local a = Ax
    function dec(b)
        b = string.gsub(b, '[^' .. a .. '=]', '')
        return b:gsub('.', function(c)
            if c == '=' then return '' end
            local d, e = '', a:find(c) - 1
            for f = 6, 1, -1 do
                d = d .. (e % 2^f - e % 2^(f - 1) > 0 and '1' or '0')
            end
            return d
        end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(c)
            if #c ~= 8 then return '' end
            local g = 0
            for f = 1, 8 do
                g = g + (c:sub(f, f) == '1' and 2^(8 - f) or 0)
            end
            return string.char(g)
        end)
    end

    function fromstring(h)
        local i = {}
        for j in string.gmatch(h, "%d+") do
            table.insert(i, tonumber(j))
        end
        return i
    end

    function lzw_decompress(k)
        local l = 256
        local m = {}
        for f = 0, 255 do
            m[f] = string.char(f)
        end
        local n = m[k[1]]
        local i = n
        for f = 2, #k do
            local o
            local p = k[f]
            if m[p] then
                o = m[p]
            elseif p == l then
                o = n .. n:sub(1, 1)
            end
            i = i .. o
            m[l] = n .. o:sub(1, 1)
            l = l + 1
            n = o
        end
        return i
    end

    local p4 = fromstring(dec('` + encodedScript + `'))
    return lzw_decompress(p4)
end)('${randomKey}')
`;

            document.getElementById('obfuscatedScript').value = finalObfuscatedScript;
        }

        function lzwCompress(input) {
            let dictionary = {};
            let data = input.split('');
            let out = [];
            let phrase = data[0];
            let code = 256;
            for (let i = 1; i < data.length; i++) {
                const currChar = data[i];
                if (dictionary[phrase + currChar]) {
                    phrase += currChar;
                } else {
                    out.push(phrase.length > 1 ? dictionary[phrase] : phrase.charCodeAt(0));
                    dictionary[phrase + currChar] = code;
                    code++;
                    phrase = currChar;
                }
            }
            out.push(phrase.length > 1 ? dictionary[phrase] : phrase.charCodeAt(0));
            return out;
        }

        function copyToClipboard() {
            const obfuscatedScript = document.getElementById('obfuscatedScript');
            obfuscatedScript.select();
            document.execCommand('copy');
            alert('Obfuscated script copied to clipboard!');
        }

        function downloadFile() {
            const obfuscatedScript = document.getElementById('obfuscatedScript').value;
            const blob = new Blob([obfuscatedScript], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'obfuscated_script.lua';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
