<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dumper Options</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        #output {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 20px;
            height: 200px;
            overflow-y: scroll;
            white-space: pre-wrap;
        }
        button {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>Dumper Options</h1>
    <label>
        <input type="radio" name="dumper" value="moonsec" checked> Moonsec Dumper
    </label>
    <label>
        <input type="radio" name="dumper" value="luaobfcautor"> LuaOBCFAutor Dumper
    </label>
    <div id="output"></div>
    <button id="dumpButton">Dump</button>
    <button id="copyButton">Copy Output</button>
    <button id="downloadButton">Download Output</button>
    <button id="clearButton">Clear Output</button>

    <script>
        const outputDiv = document.getElementById('output');

        // Moonsec Dumper implementation
        function moonsecDumper() {
            const output = "yes.txt";
            const Credits = "\n" + `

          _____                   _______                   _____           _______                   _____                    _____                    _____          
         /\\    \\                 /::\\    \\                 /\\    \\         /::\\    \\                 /\\    \\                  /\\    \\                  /\\    \\         
        /::\\    \\               /::::\\    \\               /::\\____\\       /::::\\    \\               /::\\    \\                /::\\    \\                /:::\\____\\        
       /::::\\    \\             /::::::\\    \\             /:::/    /      /::::::\\    \\             /::::\\    \\              /::::\\    \\              /:::/    /        
      /::::::\\    \\           /::::::::\\    \\           /:::/    /      /::::::::\\    \\           /::::::\\    \\            /::::::\\    \\            /:::/    /         
     /:::/\\:::\\    \\         /:::/~~\\:::\\    \\         /:::/    /      /:::/~~\\:::\\    \\         /:::/\\:::\\    \\          /:::/\\:::\\    \\          /:::/    /          
    /:::/__\\:::\\    \\       /:::/    \\:::\\    \\       /:::/    /      /:::/    \\:::\\    \\       /:::/  \\:::\\    \\        /:::/__\\:::\\    \\        /:::/____/           
    \\:::\\   \\:::\\    \\     /:::/    / \\:::\\    \\     /:::/    /      /:::/    / \\:::\\    \\     /:::/    \\:::\\    \\      /::::\\   \\:::\\    \\       |::|    |            
  ___\\:::\\   \\:::\\    \\   /:::/____/   \\:::\\____\\   /:::/    /      /:::/____/   \\:::\\____\\   /:::/    / \\:::\\    \\    /::::::\\   \\:::\\    \\      |::|    |     _____  
 /\\   \\:::\\   \\:::\\    \\ |:::|    |     |:::|    | /:::/    /      |:::|    |     |:::|    | /:::/    /   \\:::\\ ___\\  /:::/\\:::\\   \\:::\\    \\     |::|    |    /\\    \\ 
/::\\   \\:::\\   \\:::\\____\\|:::|____|     |:::|    |/:::/____/       |:::|____|     |:::|    |/:::/____/     \\:::|    |/:::/__\\:::\\   \\:::\\____\\    |::|    |   /::\\____\\
\\:::\\   \\:::\\   \\::/    / \\:::\\    \\   /:::/    / \\:::\\    \\        \\:::\\    \\   /:::/    / \\:::\\    \\     /:::|____|\\:::\\   \\:::\\   \\::/    /    |::|    |  /:::/    /
 \\:::\\   \\:::\\   \\::/____/   \\:::\\    \\ /:::/    /   \\:::\\    \\        \\:::\\    \\ /:::/    /   \\:::\\    /:::/    /    \\:::\\   \\:::\\   \\/____/     |::|    | /:::/    / 
  \\:::\\   \\:::\\____\\        \\:::\\    /:::/    /     \\:::\\    \\        \\:::\\__/:::/    /     \\:::\\  /:::/    /      \\:::\\   \\:::\\____\\        |::|____|/:::/    /  
   \\:::\\  /:::/    /         \\::::::::/    /         \\:::\\    \\        \\::::::::/    /       \\:::\\  /:::/    /        \\:::\\   \\:::\\____\\        |:::::::::::/    /   
    \\:::\/:::/    /           \\::::::/    /           \\:::\\    \\        \\::::::/    /         \\::::::/    /          \\:::\\    \\                                  
     \\::::::/    /             \\::::/    /             \\:::\\    \\        \\::/____/             \\::::/    /            \\:::\\____\\                                 
      \\::::/    /               \\::/____/               \\::/    /         ~~                      \\::/    /              \\::/    /                                 
       \\::/    /                 ~~                      \\::/    /                                   ~~                       \\::/    /                                 
        \\____/                                           \\____/                                   ~~                       \\____/                                  
                                                                                                                                           
                                                                    Moonsec V3 Dumper made by Solodev
`;

            const functionCode = `
local function appendfile(filename,content)
    if not isfile(filename) then 
        writefile(filename,string.format("%s\\n %s",Credits,content))
    end 

    return old_append(filename,content)
end 

local function format(tab)
    local result = "{"
    for index, value in pairs(tab) do
        if type(value) == "table" then
            result = result .. format(value)
        else
            result = result .. string.format("\\n'Index: %s' | 'Value: %s', ", tostring(index), tostring(value))
        end
    end
    result = result:sub(1, -3) .. "\\n},\\n" 
    return result
end

local function foreach(tab)
    if type(tab) == "table" then 
        for index, value in pairs(tab) do 
            if type(value) == "table" then
                appendfile(output, format(value) .. "\\n")
            else
                appendfile(output, string.format("{Index: %s | Value: %s\\n", tostring(index), tostring(value)))
            end
        end
    end 
end 

function unpack(...)
    if type(old(...)) == "table" then 
        foreach(old(...))
    end 
    return old(...)
end 
`;

            outputDiv.textContent += functionCode;
        }

        // LuaOBCFAutor Dumper implementation
        function luaobfcautorDumper() {
            const functionCode = `
local old = table 
table = {}

table.concat = function(...)
     print(old.concat(...))
     return old.concat(...)
end

table.insert = old.insert
`;

            outputDiv.textContent += functionCode;
        }

        // Event listener for dumper selection
        document.querySelectorAll('input[name="dumper"]').forEach((elem) => {
            elem.addEventListener('change', function() {
                outputDiv.textContent = ''; // Clear output on change
            });
        });

        // Dump button functionality
        document.getElementById('dumpButton').onclick = () => {
            const selectedDumper = document.querySelector('input[name="dumper"]:checked').value;
            outputDiv.textContent = ''; // Clear previous output
            if (selectedDumper === 'moonsec') {
                moonsecDumper(); // Execute Moonsec Dumper
            } else {
                luaobfcautorDumper(); // Execute LuaOBCFAutor Dumper
            }
        };

        // Copy output to clipboard
        document.getElementById('copyButton').onclick = () => {
            navigator.clipboard.writeText(outputDiv.textContent)
                .then(() => alert('Output copied to clipboard!'))
                .catch(err => console.error('Could not copy text: ', err));
        };

        // Download output as text file
        document.getElementById('downloadButton').onclick = () => {
            const blob = new Blob([outputDiv.textContent], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.download = 'output.txt';
            link.click();
        };

        // Clear output
        document.getElementById('clearButton').onclick = () => {
            outputDiv.textContent = '';
        };
    </script>
</body>
</html>
